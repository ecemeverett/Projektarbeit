<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Validation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: url('/static/advise.jpg') no-repeat center center fixed;
            background-size: cover;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        textarea {
            width: 100%;
            height: 150px;
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ddd;
            resize: vertical;
        }

        .impressum-textarea {
            width: 100%;
            height: 50px;
            font-size: 14px;
            margin-top: 10px;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ddd;
            resize: vertical;
        }

        button {
            padding: 15px 25px;
            font-size: 18px;
            margin-top: 20px;
            background-color: #502cba;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #3a2394;
        }

        .button2 {
            padding: 15px 25px;
            font-size: 18px;
            margin-top: 40px;
            background-color: #502cba;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }

        .button2:hover {
            background-color: #3a2394;
        }

        .additional-field {
            margin-top: 10px;
        }

        label {
            font-weight: bold;
            margin-top: 15px;
            display: block;
            text-align: left;
        }

        .tooltip {
            font-size: 12px;
            color: #666;
            display: block;
            margin-bottom: 10px;
            text-align: left;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Enter Texts for Validation</h1>
        <form method="POST">
            <input type="hidden" name="url" value="{{ url }}">

            <label for="impressum">Impressum Check</label>
            <span class="tooltip">Provide the required terms for Impressum validation. You can add multiple
                fields.</span>

            <!-- Vorhandene Impressum-Felder anzeigen -->
            <div id="additional-fields">
                {% for term in templates.get('additional_impressum', []) %}
                <textarea name="additional_impressum[]" class="impressum-textarea"
                    placeholder="Enter additional term">{{ term }}</textarea>
                {% endfor %}
            </div>
            <div class="button-container">
                <button type="button" onclick="addImpressumField()">Add More Fields</button>
                <button type="button" style="background-color: orange;" onclick="resetImpressumFields()">Reset Impressum
                    Fields</button>
            </div>

            <label for="cookie_policy">Cookie Policy Check</label>
            <span class="tooltip">Provide the template for the cookie policy text.</span>
            <textarea id="cookie_policy" name="cookie_policy"
                placeholder="Enter Cookie Policy text here">{{ templates['cookie_policy'] | safe }}</textarea>

            <label for="newsletter">Newsletter Check</label>
            <span class="tooltip">Enter the expected wording for the newsletter subscription section.</span>
            <textarea id="newsletter" name="newsletter"
                placeholder="Enter Newsletter text here">{{ templates['newsletter'] | safe }}</textarea>


            <label for="newsletterdetail">Newsletter more Details Check</label>
            <span class="tooltip">Enter the expected wording for the Newsletter "More Details" Pop-Up text.</span>
            <textarea id="newsletterdetail" name="newsletterdetail"
                placeholder="Enter More Details for the Newsletter here">{{ templates['newsletterdetail'] | safe }}</textarea>

            <button type="submit">Validate Texts</button>
            <a href="{{ url_for('index') }}" class="button2">Back to Start</a>
            <button type="button" style="background-color: red;" onclick="resetToDefault()">Reset to Default</button>
        </form>
    </div>
    <script>
        document.querySelector('form').addEventListener('submit', function () {
            const fields = document.querySelectorAll('.impressum-textarea');
            fields.forEach(field => {
                if (!field.value.trim()) {
                    field.value = ''; // Leeren Wert explizit setzen
                }
            });
        });

        // Dynamisch ein neues Feld hinzufügen
        function addImpressumField() {
            const additionalFields = document.getElementById('additional-fields');
            const newField = document.createElement('textarea');
            newField.name = 'additional_impressum[]';
            newField.classList.add('impressum-textarea');
            newField.placeholder = 'Enter additional term';
            additionalFields.appendChild(newField);
        }

        function resetImpressumFields() {
            // Leere den Inhalt des Containers
            document.getElementById('additional-fields').innerHTML = '';
        }

        function resetToDefault() {
            fetch('{{ url_for("reset_templates") }}', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
            }).then(response => {
                if (response.ok) {
                    // Die Standardwerte aus `DEFAULT_TEMPLATES` setzen

                    document.getElementById('newsletterdetail').value = `{{ DEFAULT_TEMPLATES["newsletterdetail"] }}`;
                    document.getElementById('cookie_policy').value = `{{ DEFAULT_TEMPLATES["cookie_policy"] }}`;
                    document.getElementById('newsletter').value = `{{ DEFAULT_TEMPLATES["newsletter"] }}`;

                    // Zusätzliche Impressum-Felder löschen
                    const additionalFields = document.getElementById('additional-fields');
                    additionalFields.innerHTML = '';

                    alert('All fields have been reset to default!');
                } else {
                    alert('Failed to reset to default.');
                }
            }).catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
</body>

</html>